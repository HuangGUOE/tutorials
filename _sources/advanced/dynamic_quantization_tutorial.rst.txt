
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "advanced/dynamic_quantization_tutorial.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_advanced_dynamic_quantization_tutorial.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_advanced_dynamic_quantization_tutorial.py:


(beta) Dynamic Quantization on an LSTM Word Language Model
==================================================================

**Author**: `James Reed <https://github.com/jamesr66a>`_

**Edited by**: `Seth Weidman <https://github.com/SethHWeidman/>`_

Introduction
------------

Quantization involves converting the weights and activations of your model from float
to int, which can result in smaller model size and faster inference with only a small
hit to accuracy.

In this tutorial, we will apply the easiest form of quantization -
`dynamic quantization <https://pytorch.org/docs/stable/quantization.html#torch.quantization.quantize_dynamic>`_ -
to an LSTM-based next word-prediction model, closely following the
`word language model <https://github.com/pytorch/examples/tree/master/word_language_model>`_
from the PyTorch examples.

.. GENERATED FROM PYTHON SOURCE LINES 22-32

.. code-block:: default


    # imports
    import os
    from io import open
    import time

    import torch
    import torch.nn as nn
    import torch.nn.functional as F








.. GENERATED FROM PYTHON SOURCE LINES 33-39

1. Define the model
-------------------

Here we define the LSTM model architecture, following the
`model <https://github.com/pytorch/examples/blob/master/word_language_model/model.py>`_
from the word language model example.

.. GENERATED FROM PYTHON SOURCE LINES 39-73

.. code-block:: default


    class LSTMModel(nn.Module):
        """Container module with an encoder, a recurrent module, and a decoder."""

        def __init__(self, ntoken, ninp, nhid, nlayers, dropout=0.5):
            super(LSTMModel, self).__init__()
            self.drop = nn.Dropout(dropout)
            self.encoder = nn.Embedding(ntoken, ninp)
            self.rnn = nn.LSTM(ninp, nhid, nlayers, dropout=dropout)
            self.decoder = nn.Linear(nhid, ntoken)

            self.init_weights()

            self.nhid = nhid
            self.nlayers = nlayers

        def init_weights(self):
            initrange = 0.1
            self.encoder.weight.data.uniform_(-initrange, initrange)
            self.decoder.bias.data.zero_()
            self.decoder.weight.data.uniform_(-initrange, initrange)

        def forward(self, input, hidden):
            emb = self.drop(self.encoder(input))
            output, hidden = self.rnn(emb, hidden)
            output = self.drop(output)
            decoded = self.decoder(output)
            return decoded, hidden

        def init_hidden(self, bsz):
            weight = next(self.parameters())
            return (weight.new_zeros(self.nlayers, bsz, self.nhid),
                    weight.new_zeros(self.nlayers, bsz, self.nhid))








.. GENERATED FROM PYTHON SOURCE LINES 74-82

2. Load in the text data
------------------------

Next, we load the
`Wikitext-2 dataset <https://www.google.com/search?q=wikitext+2+data>`_ into a `Corpus`,
again following the
`preprocessing <https://github.com/pytorch/examples/blob/master/word_language_model/data.py>`_
from the word language model example.

.. GENERATED FROM PYTHON SOURCE LINES 82-132

.. code-block:: default


    class Dictionary(object):
        def __init__(self):
            self.word2idx = {}
            self.idx2word = []

        def add_word(self, word):
            if word not in self.word2idx:
                self.idx2word.append(word)
                self.word2idx[word] = len(self.idx2word) - 1
            return self.word2idx[word]

        def __len__(self):
            return len(self.idx2word)


    class Corpus(object):
        def __init__(self, path):
            self.dictionary = Dictionary()
            self.train = self.tokenize(os.path.join(path, 'train.txt'))
            self.valid = self.tokenize(os.path.join(path, 'valid.txt'))
            self.test = self.tokenize(os.path.join(path, 'test.txt'))

        def tokenize(self, path):
            """Tokenizes a text file."""
            assert os.path.exists(path)
            # Add words to the dictionary
            with open(path, 'r', encoding="utf8") as f:
                for line in f:
                    words = line.split() + ['<eos>']
                    for word in words:
                        self.dictionary.add_word(word)

            # Tokenize file content
            with open(path, 'r', encoding="utf8") as f:
                idss = []
                for line in f:
                    words = line.split() + ['<eos>']
                    ids = []
                    for word in words:
                        ids.append(self.dictionary.word2idx[word])
                    idss.append(torch.tensor(ids).type(torch.int64))
                ids = torch.cat(idss)

            return ids

    model_data_filepath = 'data/'

    corpus = Corpus(model_data_filepath + 'wikitext-2')








.. GENERATED FROM PYTHON SOURCE LINES 133-141

3. Load the pre-trained model
-----------------------------

This is a tutorial on dynamic quantization, a quantization technique
that is applied after a model has been trained. Therefore, we'll simply load some
pre-trained weights into this model architecture; these weights were obtained
by training for five epochs using the default settings in the word language model
example.

.. GENERATED FROM PYTHON SOURCE LINES 141-161

.. code-block:: default


    ntokens = len(corpus.dictionary)

    model = LSTMModel(
        ntoken = ntokens,
        ninp = 512,
        nhid = 256,
        nlayers = 5,
    )

    model.load_state_dict(
        torch.load(
            model_data_filepath + 'word_language_model_quantize.pth',
            map_location=torch.device('cpu')
            )
        )

    model.eval()
    print(model)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    LSTMModel(
      (drop): Dropout(p=0.5, inplace=False)
      (encoder): Embedding(33278, 512)
      (rnn): LSTM(512, 256, num_layers=5, dropout=0.5)
      (decoder): Linear(in_features=256, out_features=33278, bias=True)
    )




.. GENERATED FROM PYTHON SOURCE LINES 162-165

Now let's generate some text to ensure that the pre-trained model is working
properly - similarly to before, we follow
`here <https://github.com/pytorch/examples/blob/master/word_language_model/generate.py>`_

.. GENERATED FROM PYTHON SOURCE LINES 165-190

.. code-block:: default


    input_ = torch.randint(ntokens, (1, 1), dtype=torch.long)
    hidden = model.init_hidden(1)
    temperature = 1.0
    num_words = 1000

    with open(model_data_filepath + 'out.txt', 'w') as outf:
        with torch.no_grad():  # no tracking history
            for i in range(num_words):
                output, hidden = model(input_, hidden)
                word_weights = output.squeeze().div(temperature).exp().cpu()
                word_idx = torch.multinomial(word_weights, 1)[0]
                input_.fill_(word_idx)

                word = corpus.dictionary.idx2word[word_idx]

                outf.write(str(word.encode('utf-8')) + ('\n' if i % 20 == 19 else ' '))

                if i % 100 == 0:
                    print('| Generated {}/{} words'.format(i, 1000))

    with open(model_data_filepath + 'out.txt', 'r') as outf:
        all_output = outf.read()
        print(all_output)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    | Generated 0/1000 words
    | Generated 100/1000 words
    | Generated 200/1000 words
    | Generated 300/1000 words
    | Generated 400/1000 words
    | Generated 500/1000 words
    | Generated 600/1000 words
    | Generated 700/1000 words
    | Generated 800/1000 words
    | Generated 900/1000 words
    b'Black' b'Fruit' b'Times' b'to' b'the' b'ground' b'.' b'Hitchcock' b'was' b'invited' b'as' b'a' b'major' b'form' b'of' b'medical' b'newspaper' b'scholarly' b'observations' b'in'
    b'offside' b',' b'and' b'that' b'one' b'of' b'his' b'father' b'who' b'appears' b'to' b'<unk>' b'their' b'contract' b'bills' b'by' b'1281' b'against' b'his' b'<unk>'
    b'.' b'The' b'jar' b'of' b'his' b'wife' b'will' b'be' b'learnt' b'on' b'one' b'of' b'his' b'small' b'candidates' b'in' b'the' b'same' b'year' b','
    b'and' b'to' b'be' b'killed' b'and' b'political' b'GCSE' b'or' b'terrestrial' b',' b'and' b'flatly' b'calls' b'the' b'score' b',' b'both' b',' b'which' b'there'
    b'is' b'no' b'threat' b'@-@' b'consciousness' b'that' b'was' b'posing' b'"' b'by' b'Cool' b'"' b'.' b'The' b'Milky' b'History' b'appears' b'to' b'have' b'officially'
    b'declined' b'in' b'legitimacy' b',' b'Ceres' b'controversial' b',' b'<unk>' b',' b'<unk>' b',' b'Incident' b',' b'back' b'intercede' b',' b'and' b'illustrious' b'but' b'had'
    b'expressed' b'his' b'father' b'.' b'All' b'decades' b'from' b'the' b'narration' b'in' b'dodo' b'were' b'the' b'title' b'unpopular' b'in' b'a' b'Jeremy' b'legal' b'health'
    b';' b'Walpole' b'himself' b'also' b'voiced' b'a' b'<unk>' b'theatre' b'arranged' b'in' b'his' b'1966' b'spiritual' b'election' b'and' b'the' b'oak' b'machinery' b'problem' b'.'
    b'Cleveland' b'who' b'told' b'and' b'<unk>' b"'s" b'book' b'seductress' b'<unk>' b'in' b'Steve' b'Doran' b'from' b'periods' b'of' b'the' b'velvet' b'AU' b'.' b'<eos>'
    b'The' b'series' b'was' b'aware' b'of' b'his' b'working' b'novels' b'at' b'the' b'VVS' b'.' b'<eos>' b'<eos>' b'=' b'=' b'Background' b'=' b'=' b'<eos>'
    b'<eos>' b'<eos>' b'=' b'=' b'=' b'Reception' b'=' b'=' b'=' b'<eos>' b'<eos>' b'The' b'series' b'of' b'Sony' b',' b'the' b'American' b',' b'Manitoba'
    b'for' b'a' b'local' b'<unk>' b'project' b',' b'earned' b'a' b'seam' b'with' b'more' b'good' b'and' b'hence' b'a' b'greatest' b'image' b'of' b'30' b'km'
    b'(' b'39' b'mi' b')' b'at' b'a' b'height' b'could' b'be' b'classified' b'\xe2\x80\x94' b'15' b'@.@' b'4' b'kg' b'(' b'#' b'60' b'km' b')'
    b',' b'so' b'71' b'kilometres' b'(' b'980' b'ft' b')' b'above' b'Mycena' b',' b'carry' b'into' b'the' b'north' b'above' b'the' b'bed' b',' b'describing'
    b'Ceres' b'a' b'Sleepy' b'naturally' b'particle' b'message' b'.' b'However' b',' b'launchers' b'is' b'use' b',' b'negative' b'as' b'they' b'transitioned' b'.' b'<unk>' b'noisy'
    b'Duke' b'and' b'ragale' b'participated' b'in' b'<unk>' b',' b'northern' b'fifth' b',' b'areas' b'.' b'<eos>' b'<eos>' b'=' b'=' b'History' b'=' b'=' b'<eos>'
    b'<eos>' b'The' b'asteroid' b'Boat' b"'s" b'Art' b'(' b'Gaelic' b'@-@' b'cloverleaf' b')' b'features' b'gray' b'built' b'in' b'the' b'northeast' b',' b'so' b'<unk>'
    b'and' b'expands' b'@-@' b'landscape' b'all' b'invading' b'@-@' b'decades' b'(' b'sing' b')' b'in' b'Norway' b'.' b'After' b'a' b'1924' b'increase' b'study' b'is'
    b'an' b'member' b'of' b'burrows' b',' b'Earth' b'is' b'unknown' b'.' b'In' b'1891' b'definition' b'of' b'Real' b',' b'rock' b'for' b'common' b'inheritance' b'is'
    b'listed' b'as' b'he' b'is' b'.' b'In' b'response' b'to' b'angular' b'difference' b',' b'others' b'are' b'known' b'as' b'Tal' b'of' b'Insular' b',' b'areas'
    b'mammal' b',' b'AAR' b',' b'and' b'Farnum' b'Barney' b'.' b'From' b'this' b'realm' b',' b'Ceres' b'Catholics' b'are' b'classified' b'as' b'an' b'Classical' b'<unk>'
    b'.' b'Numerous' b'reason' b'further' b'they' b'have' b'difficulty' b'how' b'it' b'is' b'<unk>' b'<unk>' b',' b'although' b'occasionally' b',' b'or' b'as' b'to' b'manage'
    b'activity' b',' b'preventing' b'Blackmon' b'or' b'face' b'aggressively' b',' b'measuring' b'outside' b'faster' b'severity' b'of' b'compartments' b'after' b'hearing' b'their' b'permanent' b'environment' b','
    b'especially' b'there' b'was' b'colloquially' b"'s" b'one' b'species' b'.' b'It' b'can' b'be' b'females' b'that' b'only' b'80' b'extrasolar' b'starlings' b'finance' b'the' b'mating'
    b'surface' b'interior' b'in' b'rate' b'.' b'<eos>' b'A' b'cutter' b'measure' b'was' b'only' b'recorded' b'.' b'It' b'Rocks' b',' b'the' b'garage' b'employed' b'13'
    b'@.@' b'36' b'AU' b'\xc3\x97' b'20' b'million' b',' b'(' b'other' b'roof' b'between' b'males' b'and' b')' b'per' b'year' b'(' b'not' b'redundant' b','
    b'9' b'%' b'during' b'2013' b')' b',' b'while' b'when' b'they' b'damaged' b'short' b'birds' b'by' b'an' b'eye' b'delta' b'\xe2\x80\x94' b'of' b'<unk>' b'.'
    b'<eos>' b'Within' b'example' b'with' b'many' b'cases' b',' b'any' b'adults' b'have' b'a' b'two' b'@-@' b'term' b'Category' b'3' b'that' b'mills' b'is' b'restricted'
    b'to' b'a' b'night' b'but' b'large' b'courtship' b'outer' b'protective' b'diseases' b':' b'a' b'male' b'neighbour' b'is' b'covered' b'or' b'the' b'DNA' b'eggs' b'against'
    b'paper' b'and' b'even' b'disagree' b'into' b'impossible' b'(' b'<unk>' b')' b',' b'or' b'so' b'at' b'a' b'rocky' b'face' b'date' b'.' b'Starr' b'was'
    b'subjected' b'to' b'Admirals' b'Spears' b',' b'but' b'makes' b'mid' b'@-@' b'Shimitsu' b'(' b'Vesta' b')' b',' b'flight' b',' b'Vertigo' b'(' b'persistent' b'prohibited'
    b')' b'and' b'the' b'<unk>' b'ability' b'into' b'a' b'Vale' b'.' b'The' b'spores' b'enlarged' b'sharper' b'or' b'controversial' b'even' b'strains' b'modernization' b'as' b'food'
    b'or' b'activity' b'individual' b'until' b'that' b'back' b'to' b'trees' b',' b'and' b'could' b'indicate' b'they' b'do' b'been' b'der' b'breeder' b'.' b'Shortly' b'at'
    b'1989' b',' b'she' b'will' b'have' b'26' b'stories' b'to' b'engine' b',' b'even' b'grey' b'or' b'dark' b'areas' b'until' b'which' b'synthesized' b'mating' b'displays'
    b',' b'and' b'their' b'e' b'powers' b'increased' b'commentary' b'and' b'destined' b'close' b'.' b'Once' b'they' b'occur' b'for' b'8' b'and' b'more' b'unknown' b','
    b'possibly' b'on' b'the' b'upper' b'Irish' b'floor' b'that' b'may' b'be' b'distinguished' b'by' b'food' b'.' b'They' b'do' b'access' b'to' b'their' b'father' b'just'
    b'to' b'become' b'up' b'from' b'a' b'food' b'prey' b'seeking' b'with' b'HIV' b'comburendo' b'and' b'differentiated' b'to' b'Australia' b',' b'in' b'that' b',' b'which'
    b'usually' b'their' b'wish' b'to' b'be' b'caused' b'by' b'agent' b'<unk>' b'on' b'flocks' b'of' b'the' b'<unk>' b'<unk>' b'scanning' b'.' b'The' b'other' b'occupying'
    b'<unk>' b'known' b'as' b'M.' b'galericulata' b'demands' b'well' b'to' b'archaic' b'or' b'suggests' b'to' b'have' b'mistaken' b'than' b'common' b'planets' b'who' b'frequently' b'was'
    b'an' b'food' b'relay' b',' b'so' b'still' b'<unk>' b',' b'it' b'is' b'said' b'that' b'assuming' b'goods' b'it' b'could' b'be' b'coined' b'\xe2\x80\x94' b'"'
    b'it' b'is' b'a' b'major' b'coastal' b',' b'finger' b'"' b'.' b'The' b'closest' b'soft' b'@-@' b'conical' b',' b'more' b'small' b'Spiegelman' b'is' b'typically'
    b'sighted' b'in' b'cruising' b'.' b'A' b'pattern' b'of' b'rough' b'alteration' b'the' b'courtship' b'model' b'that' b'might' b'be' b'seen' b'.' b'Local' b'spins' b'from'
    b'three' b'males' b'have' b'gone' b'by' b'the' b'cytoplasm' b'.' b'Such' b'Feast' b'that' b'may' b'be' b'dependent' b'on' b'a' b'large' b'physique' b',' b'even'
    b'one' b'such' b'once' b'they' b'may' b'have' b'such' b'orange' b'objects' b'.' b'<eos>' b'<eos>' b'=' b'=' b'Cultural' b'impact' b'=' b'=' b'<eos>' b'<eos>'
    b'As' b'of' b'1930s' b',' b'brood' b'starlings' b'functioning' b'<unk>' b'at' b'Justin' b'habitats' b',' b'where' b'it' b'seems' b'to' b'obtain' b'their' b'rise' b'.'
    b'Ceres' b'membranes' b'together' b'with' b'freedom' b'of' b'European' b'starling' b',' b'often' b'called' b'it' b'shape' b'finely' b'and' b'nesting' b'officials' b'in' b'other' b'areas'
    b'made' b'to' b'someone' b"'s" b'campgrounds' b'.' b'During' b'this' b'period' b'convection' b',' b'pale' b',' b'and' b'other' b'large' b'starlings' b'.' b'There' b'are'
    b'two' b'teeth' b',' b'each' b'of' b'which' b'are' b'commonly' b'antelope' b'.' b'They' b'may' b'be' b'distinguished' b'by' b'erect' b'paths' b';' b'some' b'remaining'
    b'birds' b'are' b'fitted' b'under' b'cells' b',' b'which' b'will' b'be' b'common' b'.' b'Within' b'maintaining' b'a' b'gleba' b',' b'the' b'kakapo' b'confront' b'a'
    b'asymptotic' b'eye' b',' b'although' b'the' b'eggs' b'or' b'with' b'them' b'are' b'gravitationally' b'taller' b'.' b'These' b'smell' b'are' b'bright' b',' b'though' b'they'





.. GENERATED FROM PYTHON SOURCE LINES 191-196

It's no GPT-2, but it looks like the model has started to learn the structure of
language!

We're almost ready to demonstrate dynamic quantization. We just need to define a few more
helper functions:

.. GENERATED FROM PYTHON SOURCE LINES 196-241

.. code-block:: default


    bptt = 25
    criterion = nn.CrossEntropyLoss()
    eval_batch_size = 1

    # create test data set
    def batchify(data, bsz):
        # Work out how cleanly we can divide the dataset into bsz parts.
        nbatch = data.size(0) // bsz
        # Trim off any extra elements that wouldn't cleanly fit (remainders).
        data = data.narrow(0, 0, nbatch * bsz)
        # Evenly divide the data across the bsz batches.
        return data.view(bsz, -1).t().contiguous()

    test_data = batchify(corpus.test, eval_batch_size)

    # Evaluation functions
    def get_batch(source, i):
        seq_len = min(bptt, len(source) - 1 - i)
        data = source[i:i+seq_len]
        target = source[i+1:i+1+seq_len].reshape(-1)
        return data, target

    def repackage_hidden(h):
      """Wraps hidden states in new Tensors, to detach them from their history."""

      if isinstance(h, torch.Tensor):
          return h.detach()
      else:
          return tuple(repackage_hidden(v) for v in h)

    def evaluate(model_, data_source):
        # Turn on evaluation mode which disables dropout.
        model_.eval()
        total_loss = 0.
        hidden = model_.init_hidden(eval_batch_size)
        with torch.no_grad():
            for i in range(0, data_source.size(0) - 1, bptt):
                data, targets = get_batch(data_source, i)
                output, hidden = model_(data, hidden)
                hidden = repackage_hidden(hidden)
                output_flat = output.view(-1, ntokens)
                total_loss += len(data) * criterion(output_flat, targets).item()
        return total_loss / (len(data_source) - 1)








.. GENERATED FROM PYTHON SOURCE LINES 242-251

4. Test dynamic quantization
----------------------------

Finally, we can call ``torch.quantization.quantize_dynamic`` on the model!
Specifically,

- We specify that we want the ``nn.LSTM`` and ``nn.Linear`` modules in our
  model to be quantized
- We specify that we want weights to be converted to ``int8`` values

.. GENERATED FROM PYTHON SOURCE LINES 251-259

.. code-block:: default


    import torch.quantization

    quantized_model = torch.quantization.quantize_dynamic(
        model, {nn.LSTM, nn.Linear}, dtype=torch.qint8
    )
    print(quantized_model)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    LSTMModel(
      (drop): Dropout(p=0.5, inplace=False)
      (encoder): Embedding(33278, 512)
      (rnn): DynamicQuantizedLSTM(512, 256, num_layers=5, dropout=0.5)
      (decoder): DynamicQuantizedLinear(in_features=256, out_features=33278, dtype=torch.qint8, qscheme=torch.per_tensor_affine)
    )




.. GENERATED FROM PYTHON SOURCE LINES 260-262

The model looks the same; how has this benefited us? First, we see a
significant reduction in model size:

.. GENERATED FROM PYTHON SOURCE LINES 262-271

.. code-block:: default


    def print_size_of_model(model):
        torch.save(model.state_dict(), "temp.p")
        print('Size (MB):', os.path.getsize("temp.p")/1e6)
        os.remove('temp.p')

    print_size_of_model(model)
    print_size_of_model(quantized_model)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Size (MB): 113.944608
    Size (MB): 79.739034




.. GENERATED FROM PYTHON SOURCE LINES 272-276

Second, we see faster inference time, with no difference in evaluation loss:

Note: we set the number of threads to one for single threaded comparison, since quantized
models run single threaded.

.. GENERATED FROM PYTHON SOURCE LINES 276-288

.. code-block:: default


    torch.set_num_threads(1)

    def time_model_evaluation(model, test_data):
        s = time.time()
        loss = evaluate(model, test_data)
        elapsed = time.time() - s
        print('''loss: {0:.3f}\nelapsed time (seconds): {1:.1f}'''.format(loss, elapsed))

    time_model_evaluation(model, test_data)
    time_model_evaluation(quantized_model, test_data)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    loss: 5.167
    elapsed time (seconds): 226.7
    loss: 5.168
    elapsed time (seconds): 124.6




.. GENERATED FROM PYTHON SOURCE LINES 289-300

Running this locally on a MacBook Pro, without quantization, inference takes about 200 seconds,
and with quantization it takes just about 100 seconds.

Conclusion
----------

Dynamic quantization can be an easy way to reduce model size while only
having a limited effect on accuracy.

Thanks for reading! As always, we welcome any feedback, so please create an issue
`here <https://github.com/pytorch/pytorch/issues>`_ if you have any.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 6 minutes  1.016 seconds)


.. _sphx_glr_download_advanced_dynamic_quantization_tutorial.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: dynamic_quantization_tutorial.py <dynamic_quantization_tutorial.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: dynamic_quantization_tutorial.ipynb <dynamic_quantization_tutorial.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
